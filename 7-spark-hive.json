{"paragraphs":[{"user":"u1","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040298989_-456295476","id":"20220612-132458_625739514","dateCreated":"2022-06-12T13:24:58+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:256","text":"%pyspark\nfrom os.path import abspath\nfrom pyspark.sql import Row\nimport pyspark\nfrom pyspark.sql import SparkSession\n\n# warehouse_location points to the default location for managed databases and tables\nwarehouse_location = abspath('spark-warehouse')","dateUpdated":"2022-06-12T13:25:17+0000","dateFinished":"2022-06-12T13:25:17+0000","dateStarted":"2022-06-12T13:25:17+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nspark = SparkSession \\\n    .builder \\\n    .appName(\"Python Spark SQL Hive integration example\") \\\n    .config(\"spark.sql.warehouse.dir\", warehouse_location) \\\n    .enableHiveSupport() \\\n    .getOrCreate()","user":"u1","dateUpdated":"2022-06-12T13:25:30+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040311411_386920871","id":"20220612-132511_1435846887","dateCreated":"2022-06-12T13:25:11+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:373","dateFinished":"2022-06-12T13:25:30+0000","dateStarted":"2022-06-12T13:25:30+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nspark.sql(\"CREATE TABLE IF NOT EXISTS src (key INT, value STRING) USING hive\")","user":"u1","dateUpdated":"2022-06-12T13:25:43+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040330417_-957761210","id":"20220612-132530_1063111287","dateCreated":"2022-06-12T13:25:30+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:448","dateFinished":"2022-06-12T13:25:44+0000","dateStarted":"2022-06-12T13:25:43+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"DataFrame[]\n"}]}},{"text":"%sh\nwget https://sadatashareagsparkml.blob.core.windows.net/hadoop-bangalore/hive_employee_data.zip\nunzip -n hive_employee_data.zip\nls -al hive_employee_data","user":"u1","dateUpdated":"2022-06-12T13:27:17+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"text","editOnDblClick":false},"editorMode":"ace/mode/text"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040343597_1307270889","id":"20220612-132543_1940415334","dateCreated":"2022-06-12T13:25:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:504","dateFinished":"2022-06-12T13:27:17+0000","dateStarted":"2022-06-12T13:27:17+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"--2022-06-12 13:27:17--  https://sadatashareagsparkml.blob.core.windows.net/hadoop-bangalore/hive_employee_data.zip\nResolving sadatashareagsparkml.blob.core.windows.net (sadatashareagsparkml.blob.core.windows.net)... 20.150.90.36\nConnecting to sadatashareagsparkml.blob.core.windows.net (sadatashareagsparkml.blob.core.windows.net)|20.150.90.36|:443... connected.\nHTTP request sent, awaiting response... 200 OK\nLength: 1366 (1.3K) [application/x-zip-compressed]\nSaving to: ‘hive_employee_data.zip’\n\n     0K .                                                     100%  348M=0s\n\n2022-06-12 13:27:17 (348 MB/s) - ‘hive_employee_data.zip’ saved [1366/1366]\n\nArchive:  hive_employee_data.zip\n  inflating: hive_employee_data/employee.txt  \n  inflating: hive_employee_data/employee_contract.txt  \n  inflating: hive_employee_data/employee_hr.txt  \n  inflating: hive_employee_data/employee_id.txt  \ntotal 24\ndrwxr-xr-x 2 zeppelin hadoop 4096 Jun 12 13:27 .\ndrwx------ 1 zeppelin hadoop 4096 Jun 12 13:27 ..\n-rw-r--r-- 1 zeppelin hadoop  387 Jun 11 08:07 employee_contract.txt\n-rw-r--r-- 1 zeppelin hadoop  129 Jun 11 08:07 employee_hr.txt\n-rw-r--r-- 1 zeppelin hadoop 1467 Jun 11 08:07 employee_id.txt\n-rw-r--r-- 1 zeppelin hadoop  225 Jun 11 08:07 employee.txt\n"}]}},{"text":"%pyspark\nspark.sql(\"SHOW TABLES\").show()","user":"u1","dateUpdated":"2022-06-12T13:27:31+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040355097_-1764933754","id":"20220612-132555_1197161237","dateCreated":"2022-06-12T13:25:55+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:585","dateFinished":"2022-06-12T13:27:32+0000","dateStarted":"2022-06-12T13:27:31+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------+---------+-----------+\n|database|tableName|isTemporary|\n+--------+---------+-----------+\n| default|      src|      false|\n+--------+---------+-----------+\n\n"}]}},{"text":"%pyspark\nspark.sql(\"CREATE DATABASE IF NOT EXISTS db_u20\").show()\n","user":"u1","dateUpdated":"2022-06-12T13:27:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040451766_243191704","id":"20220612-132731_1686849568","dateCreated":"2022-06-12T13:27:31+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:742","dateFinished":"2022-06-12T13:27:47+0000","dateStarted":"2022-06-12T13:27:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nspark.sql(\"SHOW DATABASES\").show()","user":"u1","dateUpdated":"2022-06-12T13:28:14+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040461635_-1891779942","id":"20220612-132741_1170205434","dateCreated":"2022-06-12T13:27:41+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:823","dateFinished":"2022-06-12T13:28:15+0000","dateStarted":"2022-06-12T13:28:15+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------+\n|databaseName|\n+------------+\n|      db_u20|\n|      db_u21|\n|     default|\n|    foodmart|\n+------------+\n\n"}]}},{"text":"%pyspark\nspark.sql(\"USE db_u20\").show()","user":"u1","dateUpdated":"2022-06-12T13:29:39+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040487809_-1699374844","id":"20220612-132807_1140487768","dateCreated":"2022-06-12T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1639","dateFinished":"2022-06-12T13:29:39+0000","dateStarted":"2022-06-12T13:29:39+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nspark.sql(\"SELECT current_database()\").show()","user":"u1","dateUpdated":"2022-06-12T13:29:47+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040487622_-1822879241","id":"20220612-132807_855724150","dateCreated":"2022-06-12T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1583","dateFinished":"2022-06-12T13:29:48+0000","dateStarted":"2022-06-12T13:29:47+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------------------+\n|current_database()|\n+------------------+\n|            db_u20|\n+------------------+\n\n"}]}},{"text":"%pyspark\nspark.sql(\"DROP TABLE IF EXISTS employee\").show()","user":"u1","dateUpdated":"2022-06-12T13:32:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040743785_75824288","id":"20220612-133223_1687912620","dateCreated":"2022-06-12T13:32:23+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1941","dateFinished":"2022-06-12T13:32:59+0000","dateStarted":"2022-06-12T13:32:58+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nspark.sql(\"\"\"CREATE TABLE IF NOT EXISTS employee (\n  name string,\n  work_place ARRAY<string>,\n  gender_age STRUCT<gender:string,age:int>,\n  skills_score MAP<string,int>,\n  depart_title MAP<STRING,ARRAY<STRING>>\n)\nROW FORMAT DELIMITED\nFIELDS TERMINATED BY '|'\nCOLLECTION ITEMS TERMINATED BY ','\nMAP KEYS TERMINATED BY ':'\nSTORED AS TEXTFILE\"\"\").show()","user":"u1","dateUpdated":"2022-06-12T13:33:00+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040487443_-1840192941","id":"20220612-132807_1010614117","dateCreated":"2022-06-12T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1527","dateFinished":"2022-06-12T13:33:01+0000","dateStarted":"2022-06-12T13:33:00+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nspark.sql(\"LOAD DATA LOCAL INPATH 'hive_employee_data/employee.txt' OVERWRITE INTO TABLE employee\").show()","user":"u1","dateUpdated":"2022-06-12T13:33:25+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040487263_1145089099","id":"20220612-132807_1239858926","dateCreated":"2022-06-12T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1471","dateFinished":"2022-06-12T13:33:25+0000","dateStarted":"2022-06-12T13:33:25+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nspark.sql(\"SELECT * FROM employee\").show()","user":"u1","dateUpdated":"2022-06-12T13:33:37+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040487049_1115078684","id":"20220612-132807_540599014","dateCreated":"2022-06-12T13:28:07+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1415","dateFinished":"2022-06-12T13:33:38+0000","dateStarted":"2022-06-12T13:33:37+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------+-------------------+------------+--------------------+--------------------+\n|   name|         work_place|  gender_age|        skills_score|        depart_title|\n+-------+-------------------+------------+--------------------+--------------------+\n|  Umesh|[Montreal, Toronto]|  [Male, 30]|          [DB -> 80]|[Product -> [Deve...|\n|   Will|         [Montreal]|  [Male, 35]|        [Perl -> 85]|[Product -> [Lead...|\n|Shelley|         [New York]|[Female, 27]|      [Python -> 80]|[Test -> [Lead], ...|\n|   Lucy|        [Vancouver]|[Female, 57]|[Sales -> 89, HR ...|   [Sales -> [Lead]]|\n+-------+-------------------+------------+--------------------+--------------------+\n\n"}]}},{"text":"%pyspark\nspark.sql(\"SELECT work_place FROM employee\").show()","user":"u1","dateUpdated":"2022-06-12T13:33:54+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040486846_1404025108","id":"20220612-132806_194848019","dateCreated":"2022-06-12T13:28:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1359","dateFinished":"2022-06-12T13:33:54+0000","dateStarted":"2022-06-12T13:33:54+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------------+\n|         work_place|\n+-------------------+\n|[Montreal, Toronto]|\n|         [Montreal]|\n|         [New York]|\n|        [Vancouver]|\n+-------------------+\n\n"}]}},{"text":"%pyspark\nspark.sql(\"drop table emp_simple\")\nspark.sql(\"\"\"CREATE TABLE emp_simple(\nname string,\nwork_place string\n)\"\"\").show()","user":"u1","dateUpdated":"2022-06-12T13:34:02+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040486806_1419415064","id":"20220612-132806_520005234","dateCreated":"2022-06-12T13:28:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1303","dateFinished":"2022-06-12T13:34:02+0000","dateStarted":"2022-06-12T13:34:02+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nspark.sql(\"\"\"INSERT INTO TABLE emp_simple VALUES ('Umesh', 'Toronto'),('Lucy', 'Montreal')\n\"\"\").show()","user":"u1","dateUpdated":"2022-06-12T13:34:23+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040486490_1245508562","id":"20220612-132806_1616321029","dateCreated":"2022-06-12T13:28:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1247","dateFinished":"2022-06-12T13:34:24+0000","dateStarted":"2022-06-12T13:34:23+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"++\n||\n++\n++\n\n"}]}},{"text":"%pyspark\nmy_df = spark.sql(\"SELECT * FROM emp_simple\")","user":"u1","dateUpdated":"2022-06-12T13:34:35+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040486308_1597169056","id":"20220612-132806_1925712073","dateCreated":"2022-06-12T13:28:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1191","dateFinished":"2022-06-12T13:34:35+0000","dateStarted":"2022-06-12T13:34:35+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nmy_df.write.mode(\"append\").saveAsTable(\"db_u20.table_from_spark\")","user":"u1","dateUpdated":"2022-06-12T13:34:46+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040486067_1506753065","id":"20220612-132806_1780430816","dateCreated":"2022-06-12T13:28:06+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1135","dateFinished":"2022-06-12T13:34:47+0000","dateStarted":"2022-06-12T13:34:46+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\nspark.sql(\"SELECT * FROM db_u20.table_from_spark\").show()","user":"u1","dateUpdated":"2022-06-12T13:35:13+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040485865_1767612819","id":"20220612-132805_1278451910","dateCreated":"2022-06-12T13:28:05+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1079","dateFinished":"2022-06-12T13:35:13+0000","dateStarted":"2022-06-12T13:35:13+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----+----------+\n| name|work_place|\n+-----+----------+\n|Umesh|   Toronto|\n|Umesh|   Toronto|\n| Lucy|  Montreal|\n| Lucy|  Montreal|\n+-----+----------+\n\n"}]}},{"text":"%pyspark\n","user":"u1","dateUpdated":"2022-06-12T13:27:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1655040479424_1329753246","id":"20220612-132759_935193510","dateCreated":"2022-06-12T13:27:59+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:911"}],"name":"spark-hive","id":"2H6WN6E9K","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}